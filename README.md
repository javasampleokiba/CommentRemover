# CommentRemover
CommentRemoverは、ソースコメントの一括削除および抽出を行うJavaライブラリです。

## Features
- 各種言語のソースコードからソースコメントを一括削除します（解析アルゴリズムについては後述）。
- 各種言語のソースコードからソースコメントのみを抽出します。これは例えば、コメント文字列のみを対象にした文字列検索を行いたいときなどに使えます。
- 主要言語については、そのまま使用できるコメント削除ポリシーを予め用意していますが、コメント削除ポリシーは自由にカスタマイズ可能です（コメント削除ポリシーについては後述）。

**◆解析アルゴリズム**

- コメントの開始を表す文字列（以下、コメント開始文字列）が行の中で検出された場合に、 その文字列より後ろの部分（複数行コメントの場合は次の行以降も）をコメントとみなします。
- 1行に複数のコメント開始文字列が存在する場合は、最も先頭のものをコメント開始文字列と解釈します。
- コメント開始文字列が複数定義されている場合は、最長マッチが優先です。例えば、/\*\*は/\*よりも優先して検出されます。
- コメントの開始または終了を表す文字列（以下、コメント文字列）は大文字小文字が区別されます。
- 引用符で囲まれたリテラル文字列中に現れるコメント文字列は、コメント文字列とみなさず無視されます。
- リテラル文字列中のバックスラッシュによる引用符のエスケープに対応しています。
- 言語毎に文法的に正しいかについては検知しません。例えば、コメント開始文字列は行頭になくてはならないという言語仕様があったとしても、 行の途中で検出されればそれはコメント開始文字列とみなします。
- テキストの終了までコメント終了文字列、あるいは閉じの引用符が見つからない場合は、実行時エラーとなります。

**◆コメント削除ポリシー**

| 設定項目                                               | Javaの場合のデフォルト設定 |
| ------------------------------------------------------ | -------------------------- |
| 単一行コメントの開始文字列（複数指定可）               | //                         |
| 複数行コメントの開始文字列（複数指定可）               | /\*\*, /\*                 |
| 複数行コメントの終了文字列（複数指定可）               | */, */                     |
| コメント削除によって空行となった行を削除するか（※1）   | true                       |
| コメント削除によって空白行となった行を削除するか（※1） | true                       |
| 空白文字とみなす文字列（正規表現）                     | \\s*                       |
| 引用符文字列（複数指定可）                             | "                          |
| コメント削除時の削除対象のコメント（正規表現）（※2）   | 指定なし                   |
| コメント削除時の削除対象外のコメント（正規表現）（※2） | 指定なし                   |

※1）falseの場合、処理前後で行数を維持できます。

※2）複数行コメントの場合、いずれかの行のコメントがマッチすると、そのコメント全体が削除対象 or 対象外になります。

## Requirements
Java 8 or later<br>
（テストを実行したい場合は、JUnit5）

## Usage

(under construction)


## Note
- ヒアドキュメントには対応していないため、ヒアドキュメント中でもコメント文字列が検出されます。
- 言語毎の引用符以外による特殊なリテラル文字列には対応していないため、それらリテラル文字列中でもコメント文字列が検出されます。
- コメント開始文字列に続く文字列が何であろうとコメントとみなすため、例えばPHPの場合、 コメント行の途中にコード終了タグ?>がある場合でも行末までコメントとみなされます。
- 上記の別の制限例として、例えばVBのremをコメント開始文字列として定義する場合、 "rem "などのように空白文字を付与する必要があります（そうでないとremxxxのような文字列もコメントであるとみなされるため）。
- 上記のような制限事項があるため、実行時にソースファイルを更新する場合、バックアップを取っておくことをお勧めします。

## License
[LICENSE](https://github.com/javasampleokiba/CommentRemover/blob/main/LICENSE)を参照してください。